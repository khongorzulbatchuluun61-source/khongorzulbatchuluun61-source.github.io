<!DOCTYPE html>
<html lang="mn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Мэдээ оруулах</title>
<style>
body { font-family: Arial, sans-serif; padding:20px; background:#f4f4f4; }
form { background:#fff; padding:20px; border-radius:8px; max-width:500px; margin:auto; }
input, textarea { width:100%; margin-bottom:15px; padding:8px; border-radius:4px; border:1px solid #ccc; }
button { padding:10px 15px; background:#0077cc; color:#fff; border:none; border-radius:5px; cursor:pointer; }
button:hover { background:#005fa3; }
</style>
</head>
<body>

<h1>Мэдээ оруулах</h1>
<form id="newsForm">
  <input type="text" id="title" placeholder="Гарчиг" required>
  <textarea id="description" placeholder="Тайлбар" rows="5" required></textarea>
  <input type="text" id="category" placeholder="Ангилал" required>
  <input type="file" id="image" accept="image/*" required>
  <button type="submit">Нэмэх</button>
</form>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";
import { getStorage, ref as sRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-storage.js";

const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  databaseURL: "YOUR_DB_URL",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const storage = getStorage(app);

const form = document.getElementById('newsForm');

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const title = document.getElementById('title').value;
  const description = document.getElementById('description').value;
  const category = document.getElementById('category').value;
  const imageFile = document.getElementById('image').files[0];

  if (!imageFile) return alert("Зургаа сонгоно уу!");

  // Firebase Storage-д зураг байрлуулах
  const storageRef = sRef(storage, 'news/' + imageFile.name);
  await uploadBytes(storageRef, imageFile);
  const imageUrl = await getDownloadURL(storageRef);

  // Firebase Database-д мэдээ нэмэх
  const newsRef = push(ref(db, 'news'));
  await set(newsRef, {
    title,
    description,
    category,
    image: imageUrl,
    date: new Date().toLocaleString()
  });

  alert("Мэдээ амжилттай нэмэгдлээ!");
  form.reset();
});
</script>

</body>
</html>
